---
title: "Covid91 vaccine study Final2024"
author: "Liberty Montez"
output: 
  html_document:
    number_sections: true
    toc: true
    toc_depth: 5
date: "`r Sys.Date()`" 
---

```{r include=FALSE,echo=FALSE}
require(tidyverse)
require(tigerstats)
require(forcats)
FinalDat <-read.csv(file="finalSumr2024.csv",header=TRUE)
#recode to remove the annoying "X" from the dataframe
FinalData <- FinalDat %>% select(-one_of("X"))
FinalData <- FinalData %>%
mutate(across(where(is.character), as.factor))
FinalData$treatment <- relevel(FinalData$treatment,ref="placebo")
#FinalData$infected <- relevel(FinalData$infected,ref="OK")
Males = filter(FinalData, sex =="Male")
Females = filter(FinalData, sex =="Female")
LGBTQ = filter(FinalData, LGBTQ =="LGBTQ")
Druguser = filter(FinalData, DrugUser =="yes")
```

# Introduction
    
A new  preventative vaccine (covid921) is under test in clinical trials. Given the nature of this vaccine it is suspected that the drug may exhibit different effectiveness across the variety of subpopulations tracked. Consider population subgroups by gender( guys and gals), drug use, and sexual orientation. Write a complete report that separately considers this drug for each subgroup and your recommendations as to whether people in the subgroup should take the vaccine. Structure your report in four sections each devoted to one of the four subgroups, use null and alternative hypothesis statements and correct statistical verbage when referencing p-values in conclusions.

## Males


###Numerical Results


## Females
  


## LGBTQ


## Druggies
    
```{r}
dd2 <- Druguser %>% group_by(infected,treatment) %>% summarize(count=n()) %>% mutate(prcnt=count/sum(count))


# the group_by followed by summarize(count=n())

basicC <- ggplot(dd2,aes(x=infected,y=count,fill=treatment))
basicC + geom_bar(stat="identity",position="dodge")

#Now for percentage plot

basicCC <- ggplot(dd2,aes(x=infected,y=prcnt*100,fill=treatment))
basicCC + geom_bar(stat="identity", position = "dodge")
```
    
    
This chart represents the community of drug users to non-drug users and the contraction of covid-19 while taking either the vaccine or the placebo.

This barplot shows that approximately 34% of the people who answered 'yes' to being a drug user and still received the vaccine, still got sick with covid-19. This means that around 66% of the drug users that only took the placebo still got sick from covid-19.The odds of getting covid-19 while taking the vaccine is 1:2. The drug users that took the vaccine were half as likely to get covid-19 than those taking the placebo.

There are two plots. In first plot,the x-axis represents whether the participants were infected with covid-19 or not. The y-axis represents the number (count) of people that got covid-19 or not.
In the second plot, the left two bars of the graph are all of the people that got covid-19. The x-axis determines whether a person got covid-19 or not. However, the y-axis, shows the percentage % of those who got ill with covid-19 after taking the placebo or vaccine.


### Numerical Results 

```{r}
table1 <- xtabs(~infected + treatment, data=Druguser)
rowPerc(table1)
colPerc(table1)
```
    
These numerical results show percentages of drug users that got covid-19 after taking the placebo and taking the vaccine. 33% of drug users took the vaccine and got ill with covid-19.
Those that were only given the placebo and got covid-19 was almost 67%. So far the information is showing that the vaccine to prevent covid-19 is effective in protecting drug users against covid-19 which means getting this vaccine is recommended. The odds of getting covid-19 while taking the vaccine is 1:2. The drug users that took the vaccine were half as likely to get covid-19 than those taking the placebo.


### Inferential 
    
```{r}
chisq.test(table1)
chisqtestGC(table1)
drugfish <- fisher.test(table1)
drugfish
```

  The p-value is 2.5 with that being said, the conclusion is that these results are unlikely to occur by chance because of how low the number is. The Fishers's Exact Test provides information showing that the odds ratio is 1.8, drug users who got the vaccine were about half as likely to get Covid-19 than drug users that took the placebo. The null hypothesis is rejected in favor of the alternative. The vaccine is effective in preventing the chances of getting covid-19 in drug users.

## Effectivness confidence Interval
```{r}
effect <- drugfish$p.value/(drugfish$p.value +1)
effectivenessdrug = drugfish$estimate/(drugfish$estimate +1)*100
print(effectivenessdrug)
```

```{r}
low=(drugfish$conf.int[1]/(drugfish$conf.int[1] +1))*100
hi=(drugfish$conf.int[2]/(drugfish$conf.int[2] +1))*100
options(digits=2)
```
    
The codes above show the effectiveness for the covid-19 for drug users. If the effectiveness is above 50% that means that the vaccine is effective. Based on the interval we can conclude that the vaccine is effective in protecting drug users from getting covid-19. For a vaccine to be effective the hallmark is supposed to be 60% or better. This vaccine works great in protecting drug users from contracting covid-19.
The odds ratio is approximately how effective the vaccine is. The odds ratio for the drug users can be seen above as 69. The effectiveness confidence interval for the drug users is 54.96 to 73.63.

# Overall Results and Conclusions
    
